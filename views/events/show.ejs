<%- include('../partials/header.ejs') %>

<div class="block rounded-lg w-2/4 text-center container mx-auto px-4">
  <!-- Display Event Information -->
<div class="py-3 px-6 border-b border-gray-300">
    <h1 class="my-5 font-medium text-center text-5xl"><%= event.title %></h1>
    <div>
      <span class="h4 mt-3">Location: </span>
      <span class="mx-4"><%= event.location %></span>
    </div>
    <div>
      <span class="mx-4"><%= new Date(event.date).toUTCString().split(" ").slice(0, 4).join(" ") %></span>  
    </div>
    <div>
      <span class="h4 mt-1">Start Time:</span>
      <span class="mx-4"><%= event.time %></span>  
    </div>

        <!-- Edit Event -->
    <div class="flex justify-center">
      <a href="/events/<%=event._id%>/edit" class="btn mr-3">
          <i class="fas fa-edit"></i>
      </a>
      <!-- Delete Event -->
      <form action="/events/<%=event._id%>?_method=DELETE" method="POST" id="delete-form">
          <!-- <input type="hidden" name="_method" value="DELETE"> -->
          <button onClick="return confirm('Are you sure you want to delete this event?')" class="btn" type="submit">
              <i class="fas fa-trash"></i>
          </button>
      </form>
    </div>
</div>



      <!-- Add Items Form -->
  <div class="block p-4 card">
    <h3 class="py-6 font-medium text-center text-2xl">Add Items</h3>
      <form action="/items/item/<%=event._id%>" method="POST" id="add-item">
        <div class="flex">
        <label for="name">Item</label>
        <input type="text" name="name" class="flex-2 px-4 py-2 mt-2 border rounded-md" placeholder="Add item" required>
        <label for="quantity">Quantity</label>
        <input type="number" class="flex-1 px-4 py-2 mt-2 border rounded-md" name="quantity" required>
        <label for="name">Description</label>
        <input type="text" name="description" class="flex-2 px-4 py-2 mt-2 border rounded-md" placeholder="Optional-comments">
       

      <!-- <input type="text" name="description" placeholder="">
      <label for="description">Item Description</label>
      <input type="number" name="quantity">
      <label for="quantity">Quantity</label> -->
        <button class="btn" type="submit" >Add</button>
        </div>
      </form>
  </div>

      
<!-- Show Items -->  
<div class="card">
        <h3 class="py-6 font-medium text-center text-2xl">Items Needed:</h3>
              <h5 class="text-xl font-bold leading-none text-gray-900 dark:text-white">Items</h5>
              <h5 class="text-xl font-bold leading-none text-gray-900 dark:text-white">
                  Quantity
              </h5>
              <ul>
                  <% for (let i=0; i < items.length; i++) { %> 
                  
                  <li>
                     <span><%=items[i].name %> </span> 
                      <span><%=items[i].description %></span>
                     <span> <%=items[i].quantity %></span>

                     <% if(event.userId == user) { %>
                      <span>event creator is the user</span>
                      <form action="/items/item/<%=event.id%>/<%=items[i].id %>?_method=DELETE" method="POST">
                        <button class="btn btn-danger fa fa-trash" type="submit"></button>
                        <button type="button" class="btn btn-warning fa fa-edit" id="openEdit" data-modal-toggle="modal" data-bs-target="#editItem-<%=items[i].id %>">
                        </button>
                      </form>
                      <% } %>
    

                <!-- Modal to edit Item -->
                <!--Overlay Effect-->
                <div
                class="fixed hidden inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full"
                id="my-modal"
                ></div>
                  <!-- Modal -->
                  <div class="modal fade fixed top-0 left-0 hidden w-full h-full outline-none overflow-x-hidden overflow-y-auto"
                    id="#editItem-<%=items[i].id %>" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog relative w-auto pointer-events-none">
                      <div
                        class="modal-content border-none shadow-lg relative flex flex-col w-full pointer-events-auto bg-white bg-clip-padding rounded-md outline-none text-current">
                        <div
                          class="modal-header flex flex-shrink-0 items-center justify-between p-4 border-b border-gray-200 rounded-t-md">
                          <h5 class="text-xl font-medium leading-normal text-gray-800" id="#editItem-<%=items[i].id %>">Modal title</h5>
                          <button type="button"
                            class="btn-close box-content w-4 h-4 p-1 text-black border-none rounded-none opacity-50 focus:shadow-none focus:outline-none focus:opacity-100 hover:text-black hover:opacity-75 hover:no-underline"
                            data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body relative p-4">
                          Modal body text goes here.
                        </div>
                        <div
                          class="modal-footer flex flex-shrink-0 flex-wrap items-center justify-end p-4 border-t border-gray-200 rounded-b-md">
                          <button type="button" class="btn" data-bs-dismiss="modal">Close</button>
                          <button type="button" id="submit" class="btn">Save</button>
                        </div>
                      </div>
                    </div>
                  </div>

                  </li>
                  <% } %> 
        
              </ul>
          
</div>

</div>


<%- include('../partials/footer.ejs') %>